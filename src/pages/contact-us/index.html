<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contact Us - The Wooden Stone LLC - Commercial Contractors</title>

    <!-- Canonical URL -->
    <link rel="canonical" href="https://woodenstonemi.com/contact-us">

    <!-- Enhanced Favicon for Google Search Results -->
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/android-chrome-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/android-chrome-512x512.png">

    <!-- Font preconnects to prevent FOIT/FOUT -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <!-- Inline script removed - using single source of truth in script.js -->

    <link rel="stylesheet" href="/assets/style.css">
    <script defer src="/assets/script.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@700&family=Open+Sans&display=swap"
        rel="stylesheet">
</head>

<body>
    <!-- Header -->
    <header>
        <div class="logo">
            <a href="/">
                <img src="/The Wooden Stone Logo (Transparent).svg" alt="The Wooden Stone LLC Logo">
            </a>
        </div>
        <button class="mobile-menu-toggle" aria-label="Toggle navigation menu">
            <span></span>
            <span></span>
            <span></span>
        </button>
        <nav>
            <a href="/what-we-do/">What We Do</a>
            <a href="/scopes-materials/">Scopes & Materials</a>
            <a href="/project-portfolio/">Project Portfolio</a>
            <a href="/contact-us/">Contact Us</a>
        </nav>
    </header>

    <!-- Hero Section -->
    <section class="page-hero contact-hero">
        <div class="hero-content">
            <h1>CONTACT US</h1>
            <p>Get in touch to discuss your stonework project</p>
        </div>
    </section>

    <!-- Contact Information -->
    <section class="contact-info-section">
        <div class="container">
            <div class="contact-grid">
                <div class="contact-card">
                    <h3>Email</h3>
                    <p>atocco@woodenstonemi.com</p>
                    <p>We typically respond within 24 hours</p>
                </div>
                <div class="contact-card">
                    <h3>Location</h3>
                    <p>44720 Trinity Dr</p>
                    <p>Clinton Township, MI 48038</p>
                </div>
                <div class="contact-card">
                    <h3>Service Area</h3>
                    <p>Michigan, Ohio, and Indiana</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Form -->
    <section id="request-quote" class="contact-form-section">
        <div class="container">
            <div class="form-container">
                <h2>Request a Quote</h2>
                <p>Fill out the form below and we'll get back to you with a detailed quote for your project.</p>

                <form class="contact-form" id="contactForm" action="#" method="POST" enctype="multipart/form-data">
                    <!-- Honeypot field for spam protection (hidden from users) -->
                    <div style="display: none;">
                        <input type="text" name="website" tabindex="-1" autocomplete="off">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="name">Name *</label>
                            <input type="text" id="name" name="name" required>
                        </div>
                        <div class="form-group">
                            <label for="company">Company *</label>
                            <input type="text" id="company" name="company" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="email">Email *</label>
                            <input type="email" id="email" name="email" required>
                        </div>
                        <div class="form-group">
                            <label for="phone">Phone</label>
                            <input type="tel" id="phone" name="phone" placeholder="(123) 456-7890">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="projectType">Project Type *</label>
                        <select id="projectType" name="projectType" required>
                            <option value="">Select Project Type</option>
                            <option value="multi-family">Multi-Family</option>
                            <option value="assisted-living">Assisted Living</option>
                            <option value="commercial">Commercial</option>
                            <option value="single-family">Single Family</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Interested Scopes Options (Check all that apply):</label>
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" id="stoneCountertops" name="interestedScopes"
                                    value="stone-countertops">
                                <label for="stoneCountertops">Stone Countertops</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="caseworkSupply" name="interestedScopes"
                                    value="casework-supply">
                                <label for="caseworkSupply">Casework Supply</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="caseworkInstallation" name="interestedScopes"
                                    value="casework-installation">
                                <label for="caseworkInstallation">Casework Installation</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="caseworkFinishTrim" name="interestedScopes"
                                    value="casework-finish-trim">
                                <label for="caseworkFinishTrim">Finish Trim Installation</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="sinkFixtureSupply" name="interestedScopes"
                                    value="sink-fixture-supply">
                                <label for="sinkFixtureSupply">Sink Fixture Supply</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="bathroomAccessorySupply" name="interestedScopes"
                                    value="bathroom-accessory-supply">
                                <label for="bathroomAccessorySupply">Bathroom Accessory Supply</label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="projectDescription">Project Description *</label>
                        <textarea id="projectDescription" name="projectDescription" rows="5"
                            placeholder="Please describe your project, including scope, timeline, and any specific requirements..."
                            required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="attachments">Attachments (Optional)</label>
                        <div class="file-upload-container">
                            <input type="file" id="attachments" name="attachments" multiple
                                accept=".pdf,.doc,.docx,.jpg,.jpeg,.png,.gif,.bmp,.tiff,.dwg,.dxf,.zip,.rar"
                                class="file-input">
                            <div class="file-upload-info">
                                <p>Accepted file types: PDF, Word documents, images (JPG, PNG, GIF, BMP, TIFF), CAD
                                    files (DWG, DXF), and compressed files (ZIP, RAR)</p>
                                <p>Maximum file size: 10MB per file</p>
                                <p>You can select multiple files by holding Ctrl (or Cmd on Mac) while clicking</p>
                            </div>
                            <div id="file-list" class="file-list"></div>
                        </div>
                    </div>

                    <div class="form-group">
                        <button type="submit" class="btn" id="submitBtn">Submit Request</button>
                        <div id="loading-spinner" class="loading-spinner" style="display: none;">
                            <div class="spinner"></div>
                            <span>Sending...</span>
                        </div>
                    </div>

                    <div id="form-message" class="form-message" style="display: none;"></div>
                </form>
            </div>
        </div>
    </section>

    <!-- Additional Information -->
    <section class="info-section">
        <div class="container">
            <div class="info-grid">
                <div class="info-card">
                    <h3>Why Choose The Wooden Stone?</h3>
                    <ul>
                        <li>Experienced craftsmanship</li>
                        <li>Quality materials and workmanship</li>
                        <li>On-time project completion</li>
                        <li>Comprehensive project management</li>
                        <li>Transparent pricing and communication</li>
                    </ul>
                </div>
                <div class="info-card">
                    <h3>What to Expect</h3>
                    <ol>
                        <li>Initial consultation and project assessment</li>
                        <li>Detailed proposal with material options</li>
                        <li>Project planning and timeline</li>
                        <li>Professional installation</li>
                        <li>Quality assurance and follow-up</li>
                    </ol>
                </div>
            </div>
        </div>
    </section>

    <!-- Call to Action - Hidden until business phone number is available -->
    <!--
    <section class="cta-section">
        <div class="container">
            <h2>Ready to Start Your Project?</h2>
            <p>Contact us today for a free consultation and quote</p>
            <a href="tel:+1234567890" class="btn">Call Now</a>
        </div>
    </section>
    -->

    <!-- Footer -->
    <footer>
        <p>&copy; <span id="year"></span> The Wooden Stone LLC. All rights reserved.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const form = document.getElementById('contactForm');
            const submitBtn = document.getElementById('submitBtn');
            const loadingSpinner = document.getElementById('loading-spinner');
            const formMessage = document.getElementById('form-message');

            function showMessage(message, type = 'success') {
                formMessage.textContent = message;
                formMessage.className = `form-message ${type}`;
                formMessage.style.display = 'block';

                if (type === 'success') {
                    formMessage.style.backgroundColor = '#d4edda';
                    formMessage.style.color = '#155724';
                    formMessage.style.border = '1px solid #c3e6cb';
                } else {
                    formMessage.style.backgroundColor = '#f8d7da';
                    formMessage.style.color = '#721c24';
                    formMessage.style.border = '1px solid #f5c6cb';
                }
            }

            function setLoading(loading) {
                if (loading) {
                    submitBtn.style.display = 'none';
                    loadingSpinner.style.display = 'flex';
                } else {
                    submitBtn.style.display = 'block';
                    loadingSpinner.style.display = 'none';
                }
            }

            form.addEventListener('submit', async function (e) {
                e.preventDefault();

                setLoading(true);
                formMessage.style.display = 'none';

                // Collect form data
                const formData = new FormData(form);

                // Add interested scopes to form data
                const interestedScopes = formData.getAll('interestedScopes');
                if (interestedScopes.length > 0) {
                    // Remove existing interestedScopes and add them back
                    formData.delete('interestedScopes');
                    interestedScopes.forEach(scope => {
                        formData.append('interestedScopes', scope);
                    });
                }

                try {
                    const response = await fetch('/api/contact/submit', {
                        method: 'POST',
                        body: formData // Send as FormData to handle file uploads
                    });

                    const result = await response.json();

                    if (result.success) {
                        showMessage(result.message, 'success');
                        form.reset();
                        // Clear file list after successful submission
                        currentFiles = [];
                        updateFileList();
                    } else {
                        let errorMessage = 'Please check your form and try again.';
                        if (result.errors && result.errors.length > 0) {
                            errorMessage = result.errors.map(error => error.msg).join(', ');
                        }
                        showMessage(errorMessage, 'error');
                    }
                } catch (error) {
                    console.error('Form submission error:', error);
                    showMessage('Failed to send message. Please try again later or contact us directly.', 'error');
                } finally {
                    setLoading(false);
                }
            });

            // File upload handling
            const fileInput = document.getElementById('attachments');
            const fileList = document.getElementById('file-list');
            let currentFiles = []; // Track current files

            fileInput.addEventListener('change', function () {
                const newFiles = Array.from(this.files);

                // Add new files to existing list
                newFiles.forEach(file => {
                    // Check if file already exists (by name and size)
                    const exists = currentFiles.some(existingFile =>
                        existingFile.name === file.name && existingFile.size === file.size
                    );

                    if (!exists) {
                        currentFiles.push(file);
                    }
                });

                // Update the file input with all files
                const dt = new DataTransfer();
                currentFiles.forEach(file => dt.items.add(file));
                fileInput.files = dt.files;

                // Update the display
                updateFileList();
            });

            function updateFileList() {
                fileList.innerHTML = '';

                if (currentFiles.length > 0) {
                    // Add summary info
                    const totalSize = currentFiles.reduce((sum, file) => sum + file.size, 0);
                    const summaryDiv = document.createElement('div');
                    summaryDiv.className = 'file-summary';
                    summaryDiv.innerHTML = `
                        <span class="file-count">${currentFiles.length} file${currentFiles.length > 1 ? 's' : ''} selected</span>
                        <span class="total-size">Total: ${(totalSize / 1024 / 1024).toFixed(2)} MB</span>
                    `;
                    fileList.appendChild(summaryDiv);
                }

                currentFiles.forEach((file, index) => {
                    const fileItem = document.createElement('div');
                    fileItem.className = 'file-item';

                    // Create file name span
                    const fileNameSpan = document.createElement('span');
                    fileNameSpan.className = 'file-name';
                    fileNameSpan.textContent = file.name;

                    // Create file size span
                    const fileSizeSpan = document.createElement('span');
                    fileSizeSpan.className = 'file-size';
                    fileSizeSpan.textContent = `(${(file.size / 1024 / 1024).toFixed(2)} MB)`;

                    // Create remove button
                    const removeButton = document.createElement('button');
                    removeButton.type = 'button';
                    removeButton.className = 'remove-file';
                    removeButton.textContent = '×';
                    removeButton.dataset.index = index;

                    // Add event listener to remove button
                    removeButton.addEventListener('click', function () {
                        const fileIndex = parseInt(this.dataset.index);
                        removeFile(fileIndex);
                    });

                    // Append elements to file item
                    fileItem.appendChild(fileNameSpan);
                    fileItem.appendChild(fileSizeSpan);
                    fileItem.appendChild(removeButton);

                    fileList.appendChild(fileItem);
                });
            }

            // Function to remove files
            function removeFile(index) {
                currentFiles.splice(index, 1);

                // Update the file input
                const dt = new DataTransfer();
                currentFiles.forEach(file => dt.items.add(file));
                fileInput.files = dt.files;

                updateFileList();
            }

            // Phone number formatting
            const phoneInput = document.getElementById('phone');

            phoneInput.addEventListener('input', function (e) {
                let value = e.target.value.replace(/\D/g, ''); // Remove all non-digits

                // Format the phone number
                if (value.length > 0) {
                    if (value.length <= 3) {
                        value = `(${value}`;
                    } else if (value.length <= 6) {
                        value = `(${value.slice(0, 3)}) ${value.slice(3)}`;
                    } else {
                        value = `(${value.slice(0, 3)}) ${value.slice(3, 6)}-${value.slice(6, 10)}`;
                    }
                }

                e.target.value = value;
            });

            // Set current year
            document.getElementById('year').textContent = new Date().getFullYear();
        });
    </script>
</body>

</html>